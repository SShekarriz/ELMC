---
title: "paper figures"
output: html_document
date: "2025-07-13"
---

```{r}

library(tidyverse)
library(ggpubr)
#load functions
source('./functions.R')

```

## Bins

```{r}

wrapColoniz(feature_c = "../data/clean/binCover.txt",
           donor = "DonA",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorA"))-> DonA_bins

wrapColoniz(feature_c = "../data/clean/binCover.txt",
           donor = "DonB",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorB"))-> DonB_bins


DonA_bins%>%
  rbind(DonB_bins) %>%
ggplot(
       aes(Group, n_coloniz)) +
  geom_boxplot() + geom_point() +
  facet_grid(Donor~Category, space = "free", scales = "free_x") +
  ggpubr::geom_signif(comparisons = list(c("AB", "BA")),
              map_signif_level = FALSE, y_position = 40) +
  theme_bw()

```

## MAGs

```{r}

wrapColoniz(feature_c = "../data/clean/MAGCover.txt",
           donor = "DonA",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorA"))-> DonA_MAGs

wrapColoniz(feature_c = "../data/clean/MAGCover.txt",
           donor = "DonB",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorB"))-> DonB_MAGs


DonA_MAGs%>%
  rbind(DonB_MAGs) %>%
ggplot(
       aes(Group, n_coloniz)) +
  geom_boxplot() + geom_point() +
  facet_grid(Donor~Category, space = "free", scales = "free_x") +
  ggpubr::geom_signif(comparisons = list(c("AB", "BA")),
              map_signif_level = FALSE, y_position = 25) +
  theme_bw()

```


## Genes

```{r}

wrapColoniz(feature_c = "../data/clean/geneCover.txt",
           donor = "DonA",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorA"))-> DonA_genes

wrapColoniz(feature_c = "../data/clean/geneCover.txt",
           donor = "DonB",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorB"))-> DonB_genes


DonA_genes%>%
  rbind(DonB_genes) %>%
ggplot(
       aes(Group, n_coloniz)) +
  geom_boxplot() + geom_point() +
  facet_grid(Donor~Category, space = "free", scales = "free_x") +
  ggpubr::geom_signif(comparisons = list(c("AB", "BA")),
              map_signif_level = FALSE, y_position = 70000) +
  theme_bw()

```

## Species

```{r}

wrapColoniz(feature_c = "../data/clean/speciesAbund.txt",
           donor = "DonA",
           cutoff_pres = 0.001,
           method = "Reads",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorA"))-> DonA_species

wrapColoniz(feature_c = "../data/clean/speciesAbund.txt",
           donor = "DonB",
           cutoff_pres = 0.001,
           method = "Reads",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorB"))-> DonB_species


DonA_species%>%
  rbind(DonB_species) %>%
ggplot(
       aes(Group, n_coloniz)) +
  geom_boxplot() + geom_point() +
  facet_grid(Donor~Category, space = "free", scales = "free_x") +
  ggpubr::geom_signif(comparisons = list(c("AB", "BA")),
              map_signif_level = FALSE, y_position = 85) +
  theme_bw()



```

