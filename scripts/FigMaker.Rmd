---
title: "paper figures"
output: html_document
date: "2025-07-13"
---

```{r}

library(tidyverse)
library(ggpubr)
library(cowplot)
library(ape)
library(ggtree)
library(aplot) # For aligning plots
#load functions
source('./functions.R')

```

## Bins

```{r}

CountFig(feature_c = "../data/clean/binCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt")

```

```{r}

CompFig(feature_c = "../data/clean/binCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 


```

## MAGs

```{r}

CountFig(feature_c = "../data/clean/MAGCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/MAGCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt")

```


```{r}

CompPhyloFig(feature_c = "../data/clean/MAGCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt")

```



```{r}

# read the tree and order features based on tree.tips
tree <- read.tree("../data/clean/MAGs_DonA.tree")
p_tree <- ggtree(tree, branch.length = "none") + geom_tiplab(align = TRUE)

data_tile <- data.frame(feature = tree$tip.label)

# Order data based on tree tip labels
    data_tile$feature <- factor(data_tile$feature, 
                             levels = tree$tip.label[order(match(tree$tip.label, tree$tip.label))])

    p_tile <- ggplot(data_tile, aes(x = category, y = taxa, fill = value)) +
      geom_tile() +
      scale_fill_viridis_c()

```




## Genes

```{r}

CountFig(feature_c = "../data/clean/geneCover.txt",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/geneCover.txt",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 


```

## Species

```{r}

CountFig(feature_c = "../data/clean/speciesAbund.txt",
           cutoff_pres = 0.001,
           method = "Reads",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/speciesAbund.txt",
           cutoff_pres = 0.001,
           method = "Reads",
           mapfile = "../data/clean/mapfile.txt") 


```
