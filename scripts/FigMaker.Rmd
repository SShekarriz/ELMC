---
title: "paper figures"
output: html_document
date: "2025-07-13"
---

```{r}

library(tidyverse)
library(ggpubr)
#load functions
source('./functions.R')

```

## Bins

```{r}

CountFig(feature_c = "../data/clean/binCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/binCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 


```

## MAGs

```{r}

CountFig(feature_c = "../data/clean/MAGCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/MAGCover.txt",
           cutoff_pres = 75,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 


```

## Genes

```{r}

CountFig(feature_c = "../data/clean/geneCover.txt",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/geneCover.txt",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") 


```


```{r}

wrapColoniz(feature_c = "../data/clean/geneCover.txt",
           donor = "DonA",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorA"))-> DonA_genes

wrapColoniz(feature_c = "../data/clean/geneCover.txt",
           donor = "DonB",
           cutoff_pres = 90,
           method = "Assembly",
           mapfile = "../data/clean/mapfile.txt") %>%
  mutate(Donor = paste("DonorB"))-> DonB_genes


DonA_genes%>%
  rbind(DonB_genes) %>%
ggplot(
       aes(Group, n_coloniz)) +
  geom_boxplot() + geom_point() +
  facet_grid(Donor~Category, space = "free", scales = "free_x") +
  ggpubr::geom_signif(comparisons = list(c("AB", "BA")),
              map_signif_level = FALSE, y_position = 70000) +
  theme_bw()

```

## Species

```{r}

CountFig(feature_c = "../data/clean/speciesAbund.txt",
           cutoff_pres = 0.001,
           method = "Reads",
           mapfile = "../data/clean/mapfile.txt") 

```

```{r}

CompFig(feature_c = "../data/clean/speciesAbund.txt",
           cutoff_pres = 0.001,
           method = "Reads",
           mapfile = "../data/clean/mapfile.txt") 


```
